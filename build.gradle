plugins {
    // bintray
    id "com.jfrog.bintray" version "1.6"
}

group = 'org.omegat.gradle'
version = currentVersion

apply plugin: 'groovy'
apply plugin: 'maven'
apply plugin: 'com.jfrog.bintray'

repositories {
    maven {
        url "https://dl.bintray.com/omegat-org/maven"
    }
    jcenter()
}

dependencies {
    compile gradleApi()
    compile localGroovy()
    runtime 'org.omegat:omegat:4.0.0-02'
}

compileGroovy {
    sourceCompatibility = '1.8'
    targetCompatibility = '1.8'
}

task sourceJar(type: Jar) {
    from sourceSets.main.allSource
    classifier = 'sources'
}

task createReleasePropertiesFile(type:Exec) {
    String fileName = 'omegat.plugin.release.properties'
    println "Creating $fileName"
    String fileContent = "version=$currentVersion"
    (new File("$rootDir/src/main/resources/$fileName")).write(fileContent)
}

artifacts {
    archives jar
    archives sourceJar
}

task wrapper(type: Wrapper, description: 'Gradle Wrapper task') {
    gradleVersion = '3.0'
}

if (gradle.startParameter.taskNames.contains('uploadArchives') ||
    gradle.startParameter.taskNames.contains('bintrayUpload')) {
  apply from: 'build.publish.gradle'
}
